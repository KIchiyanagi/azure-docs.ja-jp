
# <a name="azure-and-internet-of-things"></a>Azure とモノのインターネット

Microsoft Azure とモノのインターネット (IoT) にようこそ この記事では、Azure のサービスを使ってデプロイする IoT ソリューションの一般的な特性について説明します。 IoT ソリューションでは、多数のデバイスとソリューション バックエンドとの間に、セキュリティで保護された双方向通信が必要です。 ソリューション バックエンドでは、自動化された予測分析を使って、デバイスとクラウドとの間でやり取りされるイベント ストリームから知見を得ることが考えられます。

[Azure IoT Hub][lnk-iot-hub] は、Azure サービスを使う IoT ソリューションの主要構成要素です。 IoT Hub は、何百万もの IoT デバイスとソリューション バックエンド間で、セキュリティで保護された信頼性のある双方向通信を実現する、完全に管理されたサービスです。 

[Azure IoT Suite][lnk-iot-suite] を利用すれば、特定の IoT シナリオに対して、このアーキテクチャをエンド ツー エンドで包括的に実装することができます。 For example:

* 自動販売機などのデバイスの状態を "*リモート監視*" ソリューションで監視することができます。
* 遠隔地にあるポンプ場の揚水機など、装置に対する保守の必要性を "*予測メンテナンス*" ソリューションで予測することによって予定外のダウンタイムを防ぐことができます。
* "*コネクテッド ファクトリ*" ソリューションでは、産業デバイスに接続して監視することができます。

## <a name="iot-solution-architecture"></a>IoT ソリューションのアーキテクチャ

次の図は、一般的な IoT ソリューションのアーキテクチャを示しています。 この図には、特定の Azure サービス名は含まれず、一般的な IoT ソリューションのアーキテクチャの主な要素が記されています。 このアーキテクチャでは、IoT デバイスはクラウド ゲートウェイに送信するデータを収集します。 クラウド ゲートウェイは、他のバックエンド サービスが処理にデータを使用できるようにします。 ソリューション バックエンドは、基幹業務アプリケーションにデータを配信したり、ダッシュボードやレポートを使って人間のオペレーターにデータを提供したりします。

![IoT ソリューションのアーキテクチャ][img-solution-architecture]

> [!NOTE]
> IoT アーキテクチャの詳細については、「[Microsoft Azure IoT Reference Architecture (Microsoft Azure IoT リファレンス アーキテクチャ)][lnk-refarch]」を参照してください。

### <a name="device-connectivity"></a>デバイスの接続性

この IoT ソリューションでは、デバイスが、テレメトリ (ポンプ場のセンサー測定値など) を格納と処理のためにクラウド エンドポイントに送信します。 予測メンテナンスのシナリオでは、ソリューション バックエンドでセンサー データのストリームを使用して、特定のポンプのメンテナンスが必要な時期を判断することがあります。 デバイスは、クラウドからデバイスへのメッセージを受信し、クラウド エンドポイントからのメッセージを読み取り、コマンドに応答することもできます。 たとえば、予測メンテナンスのシナリオでは、ソリューション バックエンドでポンプ場のその他のポンプにメッセージを送信してメンテナンスの開始予定直前にフローの再ルーティングを開始することが考えられます。 そうすれば、メンテナンス エンジニアはすぐに問題の解決を始めることができます。

IoT プロジェクトが直面する最も大きな課題の 1 つは、ソリューション バック エンドにデバイスを確実かつ安全に接続する方法です。 IoT デバイスには、ブラウザーやモバイル アプリなどの他のクライアントとは異なる特性があります。 IoT デバイスの特性は次のとおりです。

* 多くの場合、人間が操作することのない組み込みシステムです。
* 物理アクセスに大きなコストがかかる離れた場所にデプロイされている場合があります。
* ソリューション バック エンド経由でしか到達できない場合があります。 デバイスとやり取りする他の方法はありません。
* 電源や処理リソースが限られている場合があります。
* ネットワーク接続が断続的に切れたり、遅かったり、高コストである場合があります。
* 専用、カスタム、または業界固有のアプリケーション プロトコルを使用することが必要になる場合があります。
* 一般的なハードウェアおよびソフトウェア プラットフォームを多数使用して作成できます。

上記の要件に加え、IoT ソリューションはスケール、セキュリティ、および信頼性を提供する必要もあります。 そのため、一連の接続要件は、Web コンテナーやメッセージング ブローカーなどの従来のテクノロジを使用して実装するのが難しく、時間がかかります。 Azure IoT Hub と Azure IoT device SDK を利用すると、これらの要件を満たすソリューションの実装が簡単になります。

デバイスは、クラウド ゲートウェイ エンドポイントと直接通信できます。 クラウド ゲートウェイがサポートする通信プロトコルをデバイスが使用できない場合は、中間ゲートウェイを介して接続できます。 たとえば、IoT Hub でサポートされるいずれのプロセスにもデバイスが対応していない場合、[Azure IoT プロトコル ゲートウェイ][lnk-protocol-gateway]でプロトコル変換を実行することができます。

### <a name="data-processing-and-analytics"></a>データ処理と分析

クラウドでは、IoT ソリューション バックエンドでほとんどのデータ処理が行われます。 IoT ソリューション バックエンドでは以下が行われます。

* デバイスから大量のテレメトリを受信し、そのデータを処理および格納する方法を決定します。 
* クラウドから特定のデバイスにコマンドを送信できることもあります。
* デバイスをプロビジョニングし、インフラストラクチャに接続できるデバイスを制御できるようにする、デバイス登録機能を提供します。
* デバイスの状態を追跡し、そのアクティビティを監視できます。

予測メンテナンスのシナリオでは、テレメトリ データ履歴がソリューション バックエンドで保存されます。 ソリューション バックエンドでは、このデータから、特定のポンプのメンテナンスが必要であることを示すパターンを見極めることができます。

IoT ソリューションには、自動フィードバックのループが含まれる場合があります。 たとえば、ソリューション バックエンドの分析モジュールは、テレメトリから特定のデバイスの温度が通常の運用レベルを超過していることを判別できます。 すると、ソリューションは、そのデバイスにコマンドを送信して是正措置を実行させることができます。

### <a name="presentation-and-business-connectivity"></a>プレゼンテーションおよびビジネスの接続性

プレゼンテーションおよびビジネスの接続性レイヤーでは、エンド ユーザーが IoT ソリューションおよびデバイスとやり取りできます。 このレイヤーによって、ユーザーが、デバイスから収集されたデータを表示して分析することができます。 これらのビューは、履歴データとほぼリアルタイムのデータの両方を表示できる、ダッシュボードまたはレポートの形式をとることができます。 たとえば、オペレーターは、特定のポンプ場の状態を確認し、システムによって生成されるアラートを参照できます。 また、このレイヤーによって、IoT ソリューション バックエンドと既存の基幹業務アプリケーションの統合が可能になり、企業のビジネス プロセスやワークフローと結びつけることができます。 たとえば、予測メンテナンス ソリューションは、スケジュール システムと統合できます。 ソリューションがメンテナンスの必要なポンプを識別すると、スケジュール システムがポンプ場に出向くエンジニアを予約します。

![IoT ソリューションのダッシュボード][img-dashboard]

[img-solution-architecture]: ./media/iot-azure-and-iot/iot-reference-architecture.png
[img-dashboard]: ./media/iot-azure-and-iot/iot-suite.png

[lnk-iot-hub]: ../articles/iot-hub/iot-hub-what-is-iot-hub.md
[lnk-iot-suite]: ../articles/iot-suite/iot-suite-overview.md
[lnk-machinelearning]: http://azure.microsoft.com/documentation/services/machine-learning/
[Azure IoT Suite]: http://azure.microsoft.com/solutions/iot
[lnk-protocol-gateway]:  ../articles/iot-hub/iot-hub-protocol-gateway.md
[lnk-refarch]: http://download.microsoft.com/download/A/4/D/A4DAD253-BC21-41D3-B9D9-87D2AE6F0719/Microsoft_Azure_IoT_Reference_Architecture.pdf
