---
title: "Azure IoT Hub Device Provisioning サービスにおけるサービスの概念 | Microsoft Docs"
description: "DPS と IoT Hub を備えたデバイスに固有のサービス プロビジョニングの概念を説明します。"
services: iot-dps
keywords: 
author: nberdy
ms.author: nberdy
ms.date: 09/05/2017
ms.topic: article
ms.service: iot-dps
documentationcenter: 
manager: timlt
ms.devlang: na
ms.custom: mvc
ms.translationtype: HT
ms.sourcegitcommit: 266b9b7eb228744075627e1e80710e63c27880cc
ms.openlocfilehash: 1a37f0753ab576aba9154e148b026b70877176f2
ms.contentlocale: ja-jp
ms.lasthandoff: 09/06/2017

---

# <a name="iot-hub-device-provisioning-service-concepts"></a>Azure IoT Hub Device Provisioning サービスの概念

Azure IoT Hub Device Provisioning サービスは IoT Hub のヘルパー サービスです。このサービスは、指定された IoT Hub にプロビジョニングするゼロタッチ デバイスの構成に使用されます。 デバイス プロビジョニング サービスを利用すると、セキュリティで保護されたスケーラブルな方法でいくつものデバイスをプロビジョニングできます。

デバイス プロビジョニングのプロセスには、2 つの部分があります。 最初の部分では、デバイスを*登録*することで、デバイスと IoT ソリューション間の初期接続を確立します。 2 番目の部分では、ソリューションの特定の要件に基づいて、デバイスに適切な*構成*を適用します。 両方のステップを完了すると、デバイスが完全に*プロビジョニング*されたことになります。 デバイス プロビジョニング サービスでは、デバイスにシームレスなプロビジョニング エクスペリエンスを提供するために、両方のステップを自動化しています。

この記事では、*サービス*の管理に最適なプロビジョニング概念の概要を説明します。 この記事は、デプロイのために準備されたデバイスを取得する[クラウド セットアップ手順](about-iot-dps.md#cloud-setup-step)に関わるユーザーに最も役立ちます。

## <a name="service-operations-endpoint"></a>サービス操作エンドポイント

サービス操作エンドポイントは、サービス設定を管理し加入契約リストを保持するためのエンドポイントです。 このエンドポイントは、サービス管理者によってのみ使用されます。デバイスからは使用されません。

## <a name="device-provisioning-endpoint"></a>デバイス プロビジョニングのエンドポイント

デバイス プロビジョニングのエンドポイントとは、すべてのデバイスがプロビジョニングのために通信する主要なエンドポイントです。 URL はすべてプロビジョニング サービスで同一です。サプライ チェーンのシナリオで、新しい接続情報を使用してデバイスを更新する必要はありません。 [ID スコープ](#id-scope)は、テナントの分離を確認します。

## <a name="linked-iot-hubs"></a>リンクされた IoT Hub

デバイス プロビジョニング サービスでは、このサービスにリンクされた IoT Hub にのみデバイスをプロビジョニングできます。 デバイス プロビジョニング サービスに IoT Hub をリンクすると、サービスの読み取り/書き込みのアクセス許可が IoT Hub のデバイス レジストリに付与されます。デバイス プロビジョニング サービスでは、リンクを使用して、デバイス ツインにデバイス ID を登録して初期構成を設定できます。 リンクされた IoT Hub は、任意の Azure リージョン内に置くことができます。 お使いのプロビジョニング サービスに他のサブスクリプションのハブをリンクすることもできます。

## <a name="allocation-policy"></a>割り当てポリシー

サービス レベルの設定では、デバイス プロビジョニング サービスがデバイスを IoT Hub に割り当てる方法を指定します。 次の 3 つの割り当てポリシーがサポートされています。
* **Evenly weighted distribution\(均等に重み付けされた分散\)**: リンクされた各 IoT Hub にデバイスが同程度にプロビジョニングされます。 既定の設定です。 デバイスを 1 つの IoT Hub だけにプロビジョニングしている場合、この設定を保持できます。
* **Lowest latency\(最も短い待機時間\)**: デバイスに対する待機時間が最も短い IoT Hub にデバイスをプロビジョニングします。 複数の IoT Hub にリンクしていて、同様に最も短い待機時間になっている場合、プロビジョニング サービスはそれらのハブ全体のデバイスをハッシュします。
* **Static configuration via the enrollment list\(加入契約リストによる静的構成\)**: 加入契約リストの目的の IoT Hub の仕様が、サービス レベルの割り当てポリシーよりも優先されます。

## <a name="enrollment"></a>加入

加入とは、任意の時点で登録できるデバイスまたはデバイス グループのレコードのことです。 加入レコードには、デバイスの構成証明の方法、オプションとして初期の必要な構成、必要な IoT Hub、および必要なデバイス ID など、デバイスまたはデバイス グループに関する情報が含まれています。 デバイス プロビジョニング サービスによってサポートされている加入方法は 2 種類あります。

### <a name="enrollment-group"></a>加入グループ

加入グループは、特定の構成証明メカニズムを共有するデバイスのグループです。 加入グループ内のすべてのデバイスでは、同じルート CA によって署名された X.509 証明書を提示します。 加入グループでは、X.509 構成証明メカニズムのみを使用できます。

> [!TIP]
> 必要な初期構成を共有するデバイスが多数ある場合や、デバイスがすべて同じテナントに属する予定の場合は、加入グループを使用することをお勧めします。

### <a name="individual-enrollment"></a>個別加入

個別加入は、登録する単一のデバイスのエントリです。 個別加入では、構成証明メカニズムとして X.509 証明書または (実際の TPM または仮想 TPM の) SAS トークンを使用できます。 個別加入では、必要な IoT Hub のデバイス ID が指定されている場合があります。

> [!TIP]
> 固有の初期構成を必要とするデバイスや、TPM または仮想 TPM を介した SAS トークンのみを構成証明メカニズムとして使用できるデバイスには、個別加入を使用することをお勧めします。

## <a name="registration"></a>登録

登録は、デバイス プロビジョニング サービス経由で IoT Hub に正常に登録/プロビジョニングされるデバイスのレコードです。 登録レコードは自動的に作成されます。また、削除はできますが、更新はできません。

## <a name="operations"></a>操作

操作は、デバイス プロビジョニング サービスの課金単位です。 1 つの操作は、サービスに対する 1 つの手順の正常な完了です。 操作には、デバイスの登録や再登録などがあります。加入契約リスト エントリの追加や更新といったサービス側の変更も操作に入ります。

