---
title: "Azure Stack でのオファーの委任 | Microsoft Docs"
description: "他のユーザーにオファーの作成とユーザーのサインアップを任せる方法を説明します。"
services: azure-stack
documentationcenter: 
author: AlfredoPizzirani
manager: byronr
editor: 
ms.assetid: 157f0207-bddc-42e5-8351-197ec23f9d46
ms.service: azure-stack
ms.workload: na
ms.tgt_pltfrm: na
ms.devlang: na
ms.topic: article
ms.date: 08/25/2017
ms.author: alfredop
ms.openlocfilehash: 48b75233e1a485e8fb3fbce9776a6ef398c4e99c
ms.sourcegitcommit: 6699c77dcbd5f8a1a2f21fba3d0a0005ac9ed6b7
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 10/11/2017
---
# <a name="delegating-offers-in-azure-stack"></a>Azure Stack でのオファーの委任

*適用先: Azure Stack 統合システムと Azure Stack 開発キット*

Azure Stack オペレーターとして、オファー作成とユーザー サインアップを他のユーザーに担当してもらいたいことがよくあります。 たとえば、あなたがサービス プロバイダーで、再販業者に顧客のサインアップと管理を担当してもらいたい場合です。 あるいは、あなたが組織における中枢の IT グループにいて、部門や子会社でユーザーのサインアップをして欲しい場合も同様です。

委任の機能はこうしたタスクの手助けをするもので、自分で直接行うよりも多くのユーザーに接触し管理することができます。 次の図では委任の 1 つのレベルを示していますが、Azure Stack は複数のレベルをサポートしています。 委任されたプロバイダーは、最大で 5 つのレベルまで他のプロバイダーを委任できます。

![](media/azure-stack-delegated-provider/image1.png)

Azure Stack オペレーターは、委任機能を使用して、オファーとユーザーの作成を他のユーザーに委任できます。

## <a name="roles-and-steps-in-delegation"></a>委任のロールと手順
委任を理解するには、関連する 3 つのロールがあることを頭に入れておいてください。

* Azure Stack オペレーターは Azure Stack インフラストラクチャの管理、オファー テンプレートの作成を行い、他のユーザーが彼らのユーザーにそれを提供することを委任します。
* 委任された Azure Stack オペレーターは、**委任されたプロバイダー**と呼ばれます。 他の組織 (他の Azure Active Directory ユーザーなど) に属すことができます。
* **ユーザー**はオファーにサインアップして、それらを使用してワークロードの管理、VM の作成、データの格納などを行います。

以下の図に示すように、委任の設定には 2 つの手順があります。

1. サブスクリプション サービスのみを含むプランに基づいたオファーにサブスクライブすることで、**委任されたプロバイダーを識別**します。
   このオファーにサブスクライブするユーザーは、オファーを拡張しそれにユーザーをサインアップする機能などの、Azure Stack オペレーターの機能の一部を取得します。
2. **委任されたプロバイダーにオファーを委任**します。このオファーは、委任されたプロバイダーが提供できるテンプレートとして機能します。 委任されたプロバイダーはこれで、オファーを取得し、その名前を選択し (そのサービスとクォータは変更できません)、お客様に提供できるようになりました。

![](media/azure-stack-delegated-provider/image2.png)

委任されたプロバイダーとして機能するには、ユーザーはメインのプロバイダーとの関係を確立する必要があります。つまり、サブスクリプションを作成する必要があります。 このシナリオでは、このサブスクリプションは、メイン プロバイダーの代わりにオファーを提供する権限を持つものとして委任されたプロバイダーを識別します。

このリレーションシップが確立されると、Azure Stack オペレーターは委任されたプロバイダーにオファーを委任できます。 委任されたプロバイダーはこれで、オファーを取得し、その名前を変更し (その内容は変更できません)、お客様に提供できるようになりました。

以降のセクションでは、委任されたプロバイダーの確立、オファーの委任、それにユーザーがサインアップできるかの確認の方法について説明します。

## <a name="set-up-roles"></a>ロールの設定

職場における委任されたプロバイダーを理解するには、Azure Stack オペレーター アカウントに加えて追加の Azure Active Directory アカウントが必要です。 それらを持っていない場合は、2 つのアカウントを作成します。 アカウントは、任意の AAD ユーザーに属することができます。 これらは、委任されたプロバイダー (DP) およびユーザーと呼びます。

| **ロール** | **組織の権限** |
| --- | --- |
| 委任されたプロバイダー |User |
| User |User |

## <a name="identify-the-delegated-providers"></a>委任されたプロバイダーを識別する
1. Azure Stack オペレーターとしてサインインします。
2. ユーザーを委任されたプロバイダーにするようなオファーを作成します。 これには、プランとそれに基づくオファーを作成することが必要です。
   
   a.  [プランを作成します](azure-stack-create-plan.md)。
       このプランは、サブスクリプション サービスのみを含んでいる必要があります。 この記事では、PlanForDelegation という名前のプランを使用します。
   
   b.  このプランに基づいて、[オファーを作成](azure-stack-create-offer.md)します。 この記事では、OfferToDP と呼ばれるオファーを使用します。
   
   c.  オファーの作成が完了したら、**[サブスクリプション]** &gt; **[追加]** &gt; **[新しいテナント サブスクリプション]** とクリックして、委任されたプロバイダーを利用者としてこのオファーに追加します。
   
   ![](media/azure-stack-delegated-provider/image3.png)

> [!NOTE]
> すべての Azure Stack オファーと同様に、オファーをパブリックにしてユーザーにサインアップさせる、または、プライベートのままにして Azure Stack オペレーターがサインアップを管理する、というオプションがあります。 委任されたプロバイダーは通常は小規模なグループで、参加しているユーザーを管理したいため、たいていの場合このオファーはプライベートにしておくのが適切です。
> 
> 

## <a name="azure-stack-operator-creates-the-delegated-offer"></a>Azure Stack オペレーターが委任されたオファーを作成する

委任されたプロバイダーはすでに確立しました。 次の手順は、委任することになる、そしてお客様が使用することになる、プランとオファーの作成です。 このオファーは、お客様に表示させたいとおりに定義する必要があります。委任されたプロバイダーはそこに含まれるプランとクォータを変更できないためです。

1. Azure Stack オペレーターとして、[プランを作成し](azure-stack-create-plan.md)、それに基づいた[オファー](azure-stack-create-offer.md)を作成することが必要です。 この記事には、DelegatedOffer と呼ばれるオファーを使用します。
   
   > [!NOTE]
   > このプランをパブリックにする必要はありません。 これをパブリックにすることもできますが、ほとんどの場合、委任されたプロバイダーのみにアクセス権を与えたいでしょう。 次の手順にあるようにプライベート オファーを委任すると、委任されたプロバイダーはアクセス権を持ちます。
   > 
   > 
1. オファーを委任します。 DelegatedOffer に移動し、[設定] ウィンドウで **[委任されたプロバイダー]** &gt; **[追加]** とクリックします。
2. ドロップダウン リスト ボックスから、委任されたプロバイダーのサブスクリプションを選択し、**[委任]** をクリックします。

> ![](media/azure-stack-delegated-provider/image4.png)
> 
> 

## <a name="delegated-provider-customizes-the-offer"></a>委任されたプロバイダーがオファーをカスタマイズする

委任されたプロバイダーとしてユーザー ポータルにサインインし、委任されたオファーをテンプレートとして使用して新しいオファーを作成します。

1. **[新規作成]** &gt; **[テナントのプラン]** &gt; **[オファー]** とクリックします。

    ![](media/azure-stack-delegated-provider/image5.png)


1. オファーに名前を割り当てます。 ここでは、ResellerOffer を選択します。 基になる委任されたオファーを選択し、**[作成]** をクリックします。
   
   ![](media/azure-stack-delegated-provider/image6.png)

    >[!NOTE] 
    > Azure Stack オペレーターによるオファー作成との違いに注意してください。 委任されたプロバイダーは、基本プランとアドオン プランからはプランを作成しません。委任されているオファーから選択できるだけであり、それらのオファーに変更を加えることはできません。

1. **[参照]** &gt; **[オファー]** とクリックし、オファーを選択し **[状態の変更]** をクリックして、オファーをパブリックにします。
2. 委任されたプロバイダーは、独自のポータル URL からこれらのオファーを公開します。 これらのオファーは、委任されたポータルを介してのみ表示されます。 この URL を検索し変更するには、以下を行います。
   
    a.  **[参照]**&gt; **[サービス]**&gt; **[サブスクリプション]**&gt; とクリックし、委任されたプロバイダーのサブスクリプション (ここでは *[DPSubscription])* &gt; **[プロパティ]** を選択します。
   
    b.  ポータル URL を、メモ帳など別の場所にコピーします。
   
    ![](media/azure-stack-delegated-provider/dpportaluri.png)  
   
   これで、委任されたプロバイダーとして、委任されたオファーの作成が完了しました。 委任されたプロバイダーとしてサインアウトします。 使用していたブラウザー タブを閉じます。

## <a name="sign-up-for-the-offer"></a>オファーのサインアップ
1. 新しいブラウザー ウィンドウで、前の手順で保存した、委任されたポータル URL に移動します。 ユーザーとしてポータルにサインインします。 注: この手順には委任されたポータルを使用します。 委任されたオファーは、それ以外の場合では表示されません。
2. ダッシュ ボードで、**[Get a subscription]\(サブスクリプションを取得\)** をクリックします。 委任されたプロバイダーによって作成された、委任されたオファーのみがユーザーに表示されることがわかります。

> ![](media/azure-stack-delegated-provider/image8.png)
> 
> 

これで、オファー委任のプロセスは終了です。 サブスクリプションを取得することによって、ユーザーは今すぐこのオファーにサインアップできます。

## <a name="multiple-tier-delegation"></a>複数階層の委任

複数階層の委任では、委任されたプロバイダーが他のエンティティにオファーを委任することができます。 これにより、たとえば、より深い再販業者チャネルを作成でき、Azure Stack を管理するプロバイダーがディストリビューターにオファーを委任し、さらにディストリビューターが再販業者に委任します。
Azure Stack は、最大 5 つのレベルの委任をサポートします。

オファー委任の複数階層を作成するには、委任されたプロバイダーは次のプロバイダーにオファーを委任します。 このプロセスは、Azure Stack オペレーターと同様、委任されたプロバイダーで同じです (「[Azure Stack オペレーターが委任されたオファーを作成する](#cloud-operator-creates-the-delegated-offer)」をご覧ください)。

## <a name="next-steps"></a>次のステップ
[VM のプロビジョニング](azure-stack-provision-vm.md)

